
Функция ШаблонURL1Метод1(Запрос)
	Ответ = Новый HTTPСервисОтвет(200);
	ДанныеJSON = Запрос.ПолучитьТелоКакСтроку();
	ОбновитьДанныеВодителей(ДанныеJSON);
	
	Возврат Ответ;
КонецФункции

Процедура ОбновитьДанныеВодителей(ДанныеJSON)
	Данные = ОбменДаннымиСотрудники.ПолучитьДанныеИзJSON(ДанныеJSON);
	
	Для Каждого Элемент Из Данные Цикл
		СНИЛС = Элемент.СНИЛС;
		ИНН = Элемент.ИНН;
		Наименование = Элемент.Наименование;
		Год = Элемент.ДатаРождения.Год;
		Месяц = Элемент.ДатаРождения.Месяц;
		День = Элемент.ДатаРождения.День;
		ДатаРождения = Дата(Год, Месяц, День);
		ПометкаУдаления = Элемент.ПометкаУдаления;
		Фото = Base64Значение(Элемент.Фото);
		Водитель = Справочники.Сотрудники.НайтиПоРеквизиту("СНИЛС", СНИЛС);
		
		Если Водитель.Пустая() Тогда
			НовыйВодитель = Справочники.Сотрудники.СоздатьЭлемент();
			НовыйВодитель.СНИЛС = СНИЛС;
			НовыйВодитель.ИНН = ИНН;
			НовыйВодитель.Наименование = Наименование;
			НовыйВодитель.ДатаРождения = ДатаРождения;
			НовыйВодитель.ПометкаУдаления = ПометкаУдаления;
			НовыйВодитель.Фото = Новый ХранилищеЗначения(Фото);
			НовыйВодитель.Записать();
		Иначе
			ВодительОбъект = Водитель.ПолучитьОбъект();
			ВодительОбъект.СНИЛС = СНИЛС;
			ВодительОбъект.ИНН = ИНН;
			ВодительОбъект.Наименование = Наименование;
			ВодительОбъект.ДатаРождения = ДатаРождения;			
			ВодительОбъект.ПометкаУдаления = ПометкаУдаления;
			ВодительОбъект.Фото = Новый ХранилищеЗначения(Фото);
			ВодительОбъект.Записать();
		КонецЕсли;
	КонецЦикла;	
КонецПроцедуры

